<!DOCTYPE>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Chat Lead Conversion</title>
<meta charset="UTF-8">
<script type="text/javascript">
	console.log("console log is working");
	

	var webhookPostUrl = 'https://marketingevents-e2e.api.intuit.com/v1/processData';
	var payload = {first_name: "",last_name : "",email:"",phone:"",product_family_of_interest:"",channel: "chat"};
	var product_family_of_interest_val = "QBO";

	function postData(payload,url) {
	var xhr = new XMLHttpRequest();

	// listen for `load` event
xhr.onload = () => {

    // print JSON response
    if (xhr.status >= 200 && xhr.status < 300) {
        // parse JSON
        const response = JSON.parse(xhr.responseText);
        console.log(response);
    }
};

// open request
xhr.open('POST', url);


// set `Content-Type` header
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.setRequestHeader('accept', '*/*');
xhr.setRequestHeader('Authorization', 'Intuit_APIKey intuit_apikey=preprdakyresmHQcpu5KStuX9sv6aW6Fhg4L8Sys');
xhr.setRequestHeader('SourceName','Segment - Personas Dev Test');

// send rquest with JSON payload
xhr.send(JSON.stringify(payload));

}

function handleSubmit(){
	try{
	var firstName =  document.getElementById("fname").value;
	var lastName = document.getElementById("lname").value;
	var email = document.getElementById("email").value;
	var phone = document.getElementById("phone").value;
	this.payload.first_name=firstName;
	this.payload.last_name=lastName;
	this.payload.email=email;
	this.payload.phone=phone;
	this.payload.product_family_of_interest=this.product_family_of_interest_val;

	this.postData(this.payload, this.webhookPostUrl);
}catch(error)
{
	console.log(error);
}

	return false;	
}
</script>
</head>
<body>
	<h1> ver: 12</h1>
	<form action="" method="post">
  <label for="fname">First name:</label><br>
  <input type="text" id="fname" name="fname" value=""><br><br>
  <label for="lname">Last name:</label><br>
  <input type="text" id="lname" name="lname" value=""><br><br>
  <label for="lname">Email:</label><br>
  <input type="text" id="email" name="email" value=""><br><br>
  <label for="lname">Phone:</label><br>
  <input type="text" id="phone" name="phone" value=""><br><br>


  <input type="submit" value="Submit" onclick="return handleSubmit();">
</form> 
</body>
</html>